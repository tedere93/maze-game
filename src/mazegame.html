<!DOCTYPE html>
<html>
<head>
	<title>MazeGame</title>
</head>
<body>

	<p id="beta"></p>
    <p id="gamma"></p>
    <p id="currX">X</p>
    <p id="currY">Y</p>
    <p id="canMove">CanMove</p>
    <button id="button" onclick="move(0)" style="margin-left: 25px;">U</button><br>
    <button id="button" onclick="move(1)">L</button><button id="button" onclick="move(2)">D</button><button id="button" onclick="move(3)">R</button>
    <br>
    <canvas width="400" height="400" id="mazecanvas" style="border:1px solid black;">Can't load the maze game, because your browser doesn't support HTML5.</canvas>
    <noscript>JavaScript is not enabled. To play the game, you should enable it.</noscript>

    <script type="text/javascript">
    	window.addEventListener("deviceorientation",ondevicemove);
    	var canvas = document.getElementById("mazecanvas");
        var context = canvas.getContext("2d");
        var currRectX = 15;
        var currRectY = 15;
        var newX;
        var newY;
        var mazeWidth = 556;
        var mazeHeight = 556;
        var intervalVar;

        function ondevicemove(event){

        }

        function drawFinish() {
            context.beginPath();
            context.arc(200, 15, 7, 0, 2 * Math.PI, false);
            context.closePath();
            context.fillStyle = '#00FF00';
            context.fill();
        }

        function drawObstacles(){
            context.beginPath();
            context.arc(200, 40, 17, 0, 2 * Math.PI, false);
            context.closePath();
            context.fillStyle = '#000000';
            context.fill();
        }

        function makeWhite(x, y, w, h) {
            context.beginPath();
            context.rect(x, y, w, h);
            context.closePath();
            context.fillStyle = "white";
            context.fill();
        }

        function drawRectangle(x, y, style) {
            makeWhite(currRectX, currRectY, 15, 15);
            currRectX = x;
            currRectY = y;
            context.beginPath();
            context.rect(x, y, 15, 15);
            context.closePath();
            context.fillStyle = style;
            context.fill();
            drawFinish();
        	drawObstacles();
        }

        function move(direction){
            if(direction==0){
                newX = currRectX;
                newY = currRectY - 3;
                drawRectangle(newX, newY, "#0000FF");
                currRectX = newX;
                currRectY = newY;

            } else if(direction==1){
                newX = currRectX - 3;
                newY = currRectY;
                drawRectangle(newX, newY, "#0000FF");
                currRectX = newX;
                currRectY = newY;
            } else if(direction==2){
                newX = currRectX;
                newY = currRectY + 3;
                drawRectangle(newX, newY, "#0000FF");
                currRectX = newX;
                currRectY = newY;
            } else if(direction==3){
                newX = currRectX + 3;
                newY = currRectY;
                drawRectangle(newX, newY, "#0000FF");
                currRectX = newX;
                currRectY = newY;
            }
        }

        function canMoveTo(destX, destY) {
            var imgData = context.getImageData(destX, destY, 15, 15);
            var data = imgData.data;
            var canMove = 1; // 1 means: the rectangle can move
            if (destX >= 0 && destX <= mazeWidth - 15 && destY >= 0 && destY <= mazeHeight - 15) {
                for (var i = 0; i < 4 * 15 * 15; i += 4) {
                    if (data[i] === 0 && data[i + 1] === 0 && data[i + 2] === 0) { // black
                        canMove = 0; // 0 means: the rectangle can't move
                        break;
                    }
                    else if (data[i] === 0 && data[i + 1] === 255 && data[i + 2] === 0) { // #00FF00
                        canMove = 2; // 2 means: the end point is reached
                        break;
                    }
                }
            }
            else {
                canMove = 0;
            }
            return canMove;
        }



        drawRectangle(150, 12, "#0000FF");


    </script>


    <style type="text/css">
    	#button{
    		width: 25px;
    	}
    </style>
</body>
</html>